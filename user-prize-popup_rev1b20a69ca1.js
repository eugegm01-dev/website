define(["jquery","base/view","popup","client-server"],function(a,b,c,d){"use strict";var e=b.extend({props:{classes:{popup:"b-popup-2020 b-popup-height-auto"},optionsSelector:".js-user-prize-popup",templates:{"prize-popup":"actions/tmpl/prize-popup"},css:["components.actions.prize-image-block","components.actions.prize-popup"]},public:{init:function(){this.collectPrizeData()},destroy:function(){e.__super__.destroy.call(this)}},protected:{collectPrizeData:function(){d.func("appanyaction.show_gift_for_user",{},{dataType:"json",success:function(a){var b,c,d,e;Array.isArray(a)&&a.length>=4&&(b=a[3]),b&&(c=b.can_be_shown,d=b.gift_desc,e={title:d.title,image:d.image},c&&this.showPopup(e))}.bind(this)})},showPopup:function(a){var b,d;this.popup?this.popup.show():(b=this.options,d=this.classes,a=Object.assign({},b,{prize:a}),this.render("prize-popup",a,function(a){this.popup=c.create({width:500,marginTop:20,rootCssClass:d.popup,isCentered:!0,shouldAdjustScroll:!1,header:b.head.title,content:a,buttons:[{type:"main",href:b.button.url,name:"close",text:b.button.text,callback:this.onPopupClose.bind(this)}]})}.bind(this)))},onPopupClose:function(){this.popup&&this.options.button.shouldClosePopup===!0&&this.popup.hide(),d.func("appanyaction.send_gift_to_user",{},{dataType:"json"})}}});return e});