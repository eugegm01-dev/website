define(["jquery","base/view","client-server","util/helpers"],function(a,b,c,d){"use strict";var e="unknown error",f={fetched:"fetched"},g=b.extend({public:{fetchData:function(a){var b={filed:2,target:"catalog"},g=d.extend({},b,a);c.func("app.saloban",g,{success:function(a){var b,c,d=[];try{d=JSON.parse(a)}catch(a){}Array.isArray(d)&&"ok"===d[2]?(b=this.adapter(d[3]),this.trigger(f.fetched,b)):("error"===d[2]&&(c=d[3]),console.error(c||e),this.trigger(f.fetched))}.bind(this),error:function(a){console.error(a||e),this.trigger(f.fetched)}})}},protected:{adapter:function(a){var b,c=(a||{}).data,e=0;return Array.isArray(c)?(b=a.data.map(function(a){var b,c,f,g,h,i,j,k,l,m,n,o=!!a.unread,p=a.type;return o&&e++,"platform"===p?(b=a.data||{},c=b.action_info||{},f=c.BannerThemeOptions_showcase||{},g=f.button||b.button||{},h=f.title||b.title,i=f.desc||b.desc,n="pay"===g.type||"X2"===c.ActionPlugin,m=g.url||"/actions",j={canvas:c.BannerThemeOptions_canvasPicture,payment:c.BannerThemeOptions_paymentPicture,showcase:f.pic,pic:b.pic}):(b=a.view||{},h=a.name||b.Name,i=a.desc||b.Description,n=!1,k=b.ActiveRef,j=d.extend({},b.Pictures,{carousel:a.pic}),l=b.ID),{type:p,title:h,description:i,hasPaymentAction:n,isUnread:o,ref:k,images:j,appID:l,link:m}}),{total:b.length,unread:e,items:b}):{total:0,unread:0,items:[]}}}});return g});