define(["base/view","util/helpers","app/history","models/user/journal"],function(a,b,c,d){"use strict";var e=a.extend({props:{deferred:{uploadPopup:"content-tools/photo/upload/popup"},events:{click:{method:"onClick",throttling:1e3}}},public:{destroy:function(){e.__super__.destroy.call(this),this.uploadPopup&&this.uploadPopup.destroy()},openPopup:function(){this.uploadPopup?this.uploadPopup.show():this.require("uploadPopup",function(a){this.uploadPopup=new a(b.extend(!0,{},this.options.upload,{user:d.get("email"),enableSelectAlbum:this.options.enableSelectAlbum,enableAlbums:Boolean(d.get("isCommunity")),isUploadInCommunity:Boolean(d.get("isCommunity")),isHideCoverAlbum:!this.options.isOwner,isOwner:this.options.isOwner})),this.uploadPopup.on("submit",function(){d.ready(function(){c.page(d.get("dir")+"photo/"+this.uploadPopup.getSelectedAlbumId())}.bind(this))}.bind(this)).show()}.bind(this))}},protected:{onClick:function(){this.openPopup()}}});return e});